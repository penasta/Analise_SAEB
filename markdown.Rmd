---
title: "ANÁLISE DESCRITIVA DE DADOS - RESULTADOS DO SAEB (ANEB - PROVA BRASIL) - 2017"
author: "Bruno Gondim Toledo"
date: "`r format(Sys.time(), '%d %B, %Y')`"
email: '150167636@aluno.unb.br'
organization: 'Universidade de Brasília'
url: 'https://github.com/penasta/Analise_SAEB'
output:
  pdf_document:
  number_sections: true

header-includes:
  - \usepackage{titling}
  - \pretitle{\begin{center}
    \includegraphics[width=2in,height=2in]{logo.jpg}\LARGE\\}
  - \posttitle{\end{center}}
---

```{r setup, include=FALSE}

library(readr)
library(tidyverse)
library(RColorBrewer)
library(viridis)  
library(e1071)
library(psych)
library(pastecs)
library(knitr)

amostra <- read_csv("Banco/amostra_150167636.csv")

amostra <- amostra %>%
  mutate_if(sapply(amostra, is.character), as.factor)
amostra$ANO <- factor(amostra$ANO)
amostra$MUNICIPIO <- factor(amostra$MUNICIPIO)

amostra$COMPUTADOR <- factor(amostra$COMPUTADOR,levels = c("Não tem", "Sim, um", "Sim, dois","Sim, três","quatro ou mais"))

amostra$ESC_MAE <- factor(amostra$ESC_MAE,levels = c("Nunca estudou",
"Não completou a 4.ª série/5.º ano do Ensino Fundamental ",
"Completou a 4.ª série/5.º ano, mas não completou a 8.ª série/9.º ano do Ensino Fundamental",
"Completou a 8.ª série/9.º ano do Ensino Fundamental, mas não completou o Ensino Médio",
"Completou o Ensino Médio, mas não completou a Faculdade",
"Completou a Faculdade","Não sei"))

amostra$ESC_PAI <- factor(amostra$ESC_PAI,levels = c("Nunca estudou",
"Não completou a 4.ª série/5.º ano do Ensino Fundamental ",
"Completou a 4.ª série/5.º ano, mas não completou a 8.ª série/9.º ano do Ensino Fundamental",
"Completou a 8.ª série/9.º ano do Ensino Fundamental, mas não completou o Ensino Médio",
"Completou o Ensino Médio, mas não completou a Faculdade",
"Completou a Faculdade","Não sei"))

```

\newpage

# 1. Comente sobre a coleta de dados do SAEB: população alvo, população acessível, características levantadas, método de coleta (no máximo 10 linhas).

O SAEB é realizado de dois em dois anos por amostragem de alunos, através da Avaliação Nacional da Educação Básica (Aneb) (pesquisa amostral aplicada para os alunos do 3º ao 5º ano do Ensino Fundamental e Ensino Médio, da rede pública e particular) e a Avaliação Nacional do Rendimento Escolar (Anresc) (pesquisa censitária aplicada apenas na rede pública, em alunos do 5º e 9º ano do Ensino Fundamental.) produz informações a respeito da realidade educacional por regiões brasileiras

Fonte: [Wikipedia](https://pt.wikipedia.org/wiki/Sistema_Nacional_de_Avaliação_da_Educação_Básica)

# 2. Liste as variáveis disponibilizadas na amostra que você recebeu (com seu número de matrícula) e classifique-as segundo o tipo.

ANO: Variável qualitativa nominal

REGIAO: Variável qualitativa nominal

UF: Variável qualitativa nominal

MUNICIPIO: Variável qualitativa nominal

AREA: Variável qualitativa nominal

LOCALIZACAO: Variável qualitativa nominal

DEPENDENCIA_ADM : Variável qualitativa nominal

NOTA_LP: Variável quantitativa discreta

NOTA_MT: Variável quantitativa discreta

SEXO: Variável qualitativa nominal

RACA_COR: Variável qualitativa nominal

Ano de nascimento: Variável qualitativa ordinal

COMPUTADOR: Variável qualitativa ordinal

ESC_MAE: Variável qualitativa ordinal

ESC_PAI: Variável qualitativa ordinal

USO_TEMPO_TELAS: Variável qualitativa ordinal

AFAZERES_DOM: Variável qualitativa ordinal

TRABALHO: Variável qualitativa nominal

Perspectivas: Variável qualitativa nominal

```{=tex}
\centering
\newpage
```
# 3. Escolha CINCO variáveis categóricas e apresente-as em forma tabular e gráfica. Comente os resultados.

COMPUTADOR

```{r, echo=FALSE}
ggplot(amostra,aes(COMPUTADOR)) + 
  geom_bar(na.rm=T)+ 
  scale_x_discrete(na.translate = FALSE)+ 
  ggtitle("Tem computador em casa?") +
  xlab("") +
  ylab("")
kable(table(amostra$COMPUTADOR),
      col.names=c("Tem computador em casa?","Frequência"))
```

\raggedright
44,7% dos estudantes amostrados não possuem computador em casa, e dentro dos que possuem, 40,2% dizem possuir apenas um.
\centering

\newpage

PERSPECTIVAS

```{r, echo=FALSE}
ggplot(amostra,aes(PERSPECTIVAS)) +
  geom_bar(na.rm=T)+
  scale_x_discrete(na.translate = FALSE)+ 
  ggtitle("Perspectivas futuras") +
  xlab("") +
  ylab("")
kable(table(amostra$PERSPECTIVAS),
      col.names=c("Perspectivas futuras","Frequência"))
```

\raggedright
A maior parte dos estudantes amostrados (85,9%) relatam a perspectiva de continuarem estudanto, dos quais a maioria absoluta pretende também trabalhar enquanto estudam. Uma minoria considerável (10.95%) relata não saber ainda suas perspectivas futuras.
\centering

\newpage

ESC_MAE

```{r, echo=FALSE}
ggplot(amostra,aes(ESC_MAE)) +
  geom_bar(na.rm=T)+
  scale_x_discrete(na.translate = FALSE)+ 
  ggtitle("Escolaridade da mãe") +
  xlab("") +
  ylab("")
kable(table(amostra$ESC_MAE),
      col.names=c("Escolaridade da mãe","Frequência"))
```

\raggedright
Uma parcela considerável dos estudantes amostrados (29,55%) relatam que a mãe sequer concluiu o ensino médio. Dentre as que concluíram alguma faculdade, o percentual é abaixo de 10% (9,7%)
\centering

\newpage

ESC_PAI

```{r, echo=FALSE}
ggplot(amostra,aes(ESC_PAI)) +
  geom_bar(na.rm=T)+
  scale_x_discrete(na.translate = FALSE)+ 
  ggtitle("Escolaridade do pai") +
  xlab("") +
  ylab("")
kable(table(amostra$ESC_PAI),
      col.names=c("Escolaridade do pai","Frequência"))
```

\raggedright
No caso da escolaridade paterna dentre os estudantes amostrados, uma parcela menor é relatada não ter concluído sequer o ensino médio (26,7%), porém dentre os graduados a proporção também é menor que no caso da escolaridade materna, sendo apenas 7% dos pais formados em alguma faculdade.
\centering

\newpage

AFAZERES_DOM

```{r, echo=FALSE}
ggplot(amostra,aes(AFAZERES_DOM)) +
  geom_bar(na.rm=T)+
  scale_x_discrete(na.translate = FALSE)+ 
  ggtitle("Tempo gasto fazendo trabalhos domésticos") +
  xlab("") +
  ylab("")
kable(table(amostra$AFAZERES_DOM),
      col.names=c("Tempo gasto fazendo trabalhos domésticos","Frequência"))
```

\raggedright
A grande maioria dos estudantes amostrados (86,2%) relatam terem afazeres domésticos diários.
\centering

\newpage

# 4. Para as variáveis quantitativas NOTA_LP e NOTA_MT apresente:

```{r, include=FALSE}

lp1 <- amostra$NOTA_LP[amostra$NOTA_LP<200]
lp2 <- amostra$NOTA_LP[amostra$NOTA_LP>200&amostra$NOTA_LP<250]
lp3 <- amostra$NOTA_LP[amostra$NOTA_LP>250&amostra$NOTA_LP<300]
lp4 <- amostra$NOTA_LP[amostra$NOTA_LP>300&amostra$NOTA_LP<350]
lp5 <- amostra$NOTA_LP[amostra$NOTA_LP>350]

t <- data.frame(length(lp1),length(lp2),length(lp3),length(lp4),length(lp5))

mt1 <- amostra$NOTA_MT[amostra$NOTA_MT<200]
mt2 <- amostra$NOTA_MT[amostra$NOTA_MT>200&amostra$NOTA_MT<250]
mt3 <- amostra$NOTA_MT[amostra$NOTA_MT>250&amostra$NOTA_MT<300]
mt4 <- amostra$NOTA_MT[amostra$NOTA_MT>300&amostra$NOTA_MT<350]
mt5 <- amostra$NOTA_MT[amostra$NOTA_MT>350]

t2 <- data.frame(length(mt1),length(mt2),length(mt3),length(mt4),length(mt5))
t2

colnames(t) <- c("Até 200","200 a 250","250 a 300","300 a 350","350 ou mais")
colnames(t2) <- c("Até 200","200 a 250","250 a 300","300 a 350","350 ou mais")

freq <- rbind(t,t2)
rownames(freq) <- c("Notas em língua portuguesa","Notas em matemática")

rm(t,t2,lp1,lp2,lp3,lp4,lp5,mt1,mt2,mt3,mt4,mt5)

```

## Distribuição de frequências, com intervalos de classe

```{r,echo=FALSE}
kable(freq)
```

## Histograma

```{r,echo=FALSE}

hist(amostra$NOTA_LP,
     main = "Histograma - Notas em língua portuguesa",
     xlab = "", 
     ylab = "")

hist(amostra$NOTA_MT,
     main = "Histograma - Notas em matemática",
     xlab = "", 
     ylab = "")

```

\newpage

## Medidas de posição, variabilidade, assimetria e curtose.

```{r,include=FALSE}
m1 <- quantile(amostra$NOTA_LP)
m1 <-as.data.frame(m1)
m2 <- mean(amostra$NOTA_LP)
m3 <- median(amostra$NOTA_LP)
m4 <- sd(amostra$NOTA_LP)
m5 <- max(amostra$NOTA_LP)-min(amostra$NOTA_LP)
m6 <- sum(abs(amostra$NOTA_LP-mean(amostra$NOTA_LP)))/length(amostra$NOTA_LP)
m7 <- IQR(amostra$NOTA_LP)
m8 <- skewness(amostra$NOTA_LP)
m9 <- kurtosis(amostra$NOTA_LP)
mlp <- rbind(m1,m2,m3,m4,m5,m6,m7,m8,m9)
colnames(mlp) <- "Valores"
rownames(mlp) <- c("Menor valor","Primeiro quartil","Segundo quartil","Terceiro quartil","Maior valor",
                   "Média","Mediana","Desvio padrão","Amplitude","Desvio absoluto",
                   "Amplitude interquartílica","Assimetria","Curtose")
mlp <- t(mlp)
mlp <-as.data.frame(mlp)
rm(m1,m2,m3,m4,m5,m6,m7,m8,m9)
m1 <- quantile(amostra$NOTA_MT)
m1 <-as.data.frame(m1)
m2 <- mean(amostra$NOTA_MT)
m3 <- median(amostra$NOTA_MT)
m4 <- sd(amostra$NOTA_MT)
m5 <- max(amostra$NOTA_MT)-min(amostra$NOTA_MT)
m6 <- sum(abs(amostra$NOTA_MT-mean(amostra$NOTA_MT)))/length(amostra$NOTA_MT)
m7 <- IQR(amostra$NOTA_MT)
m8 <- skewness(amostra$NOTA_MT)
m9 <- kurtosis(amostra$NOTA_MT)
mmt <- rbind(m1,m2,m3,m4,m5,m6,m7,m8,m9)
colnames(mmt) <- "Valores"
rownames(mmt) <- c("Menor valor","Primeiro quartil","Segundo quartil","Terceiro quartil","Maior valor",
                   "Média","Mediana","Desvio padrão","Amplitude","Desvio absoluto",
                   "Amplitude interquartílica","Assimetria","Curtose")
mmt <- t(mmt)
mmt <-as.data.frame(mmt)
rm(m1,m2,m3,m4,m5,m6,m7,m8,m9)
```

### Variável NOTA_LP

```{r,echo=FALSE}
kable(t(mlp))
```

### Variável NOTA_MT

```{r,echo=FALSE}
kable(t(mmt))
```

\newpage

## Box-plot

```{r,echo=FALSE}
boxplot(amostra$NOTA_MT,amostra$NOTA_LP, 
        names=c("Notas matemática","Notas português"),
        xlab="",ylab="",
        main = "Box-plot das notas em matemática e língua portuguesa")
```

\newpage

## Análise dos resultados, incluindo comentários sobre normalidade (não é para fazer testes de hipóteses).

\raggedright
Primeiramente, fazendo uma análise visual para a normalidade das variáveis: Nota em Matemática, e Nota em língua portuguesa, utilizando gráficos de densidade.
\centering

```{r,echo=FALSE}

pacman::p_load(dplyr,ggpubr)

ggdensity(amostra$NOTA_MT, 
          main = "Gráfico de densidade das notas em matemática",
          xlab = "Notas",
          ylab = "Densidade")

ggdensity(amostra$NOTA_LP, 
          main = "Gráfico de densidade das notas em língua portuguesa",
          xlab = "Notas",
          ylab = "Densidade")

```

\raggedright
Estes gráficos fornecem um julgamento visual sobre se a distribuição tem forma de sino. A forma lembra o formato de sino do gráfico de densidade da distribuição normal. Mas só isso não é suficiente para tal afirmação. 
\centering

\newpage

\raggedright
Ainda em análise visual, podemos utilizar um gráfico Q-Q (quantil-quantil), que desenha a correlação entre uma determinada amostra e a distribuição normal. Uma linha de referência de 45 graus também será plotada.
\centering

```{r,echo=FALSE}

ggqqplot(amostra$NOTA_MT, 
          main = "Gráfico Q-Q das notas em matemática",
          xlab = "Esperado",
          ylab = "Amostra")
ggqqplot(amostra$NOTA_LP, 
          main = "Gráfico Q-Q das notas em língua portuguesa",
          xlab = "Esperado",
          ylab = "Amostra")

```

\raggedright
Para os valores mais próximos aos extremos, a amostra parece divergir um pouco do esperado para a distribuição normal para ambas as variáveis. Porém, a maioria das observações centrais aparentam convergir com a normalidade.

A análise visual da normalidade é importante para compararmos de forma didática o comportamento esperado, e o de fato observado na amostragem. Porém, geralmente não é confiável por sí só. É possível usar um teste de significância comparando a distribuição da amostra com uma normal para verificar se os dados mostram ou não um desvio grave da normalidade.

Existem vários métodos para teste de normalidade, como o teste de normalidade de Kolmogorov-Smirnov e o teste de Shapiro-Wilk.
\centering

\newpage

\raggedright
Farei, portanto, um teste de normalidade para cada variável, utilizando o teste de Shapiro-Wilk para normalidade de uma amostra.

A estatística do teste é: W, dada por:

\centering
$W = \frac{(\sum_{i=1}^{n}a_{i}x_{(i)})^2 }{\sum_{i=1}^{n}(x_{i}-\bar{x})^2}$

```{r,echo=FALSE}

shapiro.test(amostra$NOTA_MT)
shapiro.test(amostra$NOTA_LP)

```

\raggedright
Do output, o p-valor < 0,05 em ambas as variáveis (Nota em matemática: 0.00006136; Nota em língua portuguesa: 0.00000002214) implica que a distribuição dos dados é significativamente diferente da distribuição normal. Em outras palavras, não podemos assumir a normalidade dessas variáveis para essa amostra.
\centering
